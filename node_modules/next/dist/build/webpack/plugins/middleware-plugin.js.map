{"version":3,"sources":["../../../../src/build/webpack/plugins/middleware-plugin.ts"],"names":["MiddlewarePlugin","SUPPORTED_NATIVE_MODULES","getEdgePolyfilledModules","handleWebpackExternalForEdgeRuntime","NAME","isUsingIndirectEvalAndUsedByExports","args","moduleGraph","runtime","module","usingIndirectEval","wp","exportsInfo","getExportsInfo","exportName","getUsed","UsageState","Unused","getEntryFiles","entryFiles","meta","opts","files","edgeSSR","isServerComponent","push","SERVER_REFERENCE_MANIFEST","CLIENT_REFERENCE_MANIFEST","sriEnabled","SUBRESOURCE_INTEGRITY_MANIFEST","filter","file","startsWith","endsWith","map","replace","NEXT_CLIENT_SSR_ENTRY_SUFFIX","MIDDLEWARE_BUILD_MANIFEST","MIDDLEWARE_REACT_LOADABLE_MANIFEST","NEXT_FONT_MANIFEST","NextBuildContext","hasInstrumentationHook","INSTRUMENTATION_HOOK_FILENAME","getCreateAssets","params","compilation","metadataByEntry","assets","middlewareManifest","sortedMiddleware","middleware","functions","version","entrypoint","entrypoints","values","metadata","name","get","page","edgeMiddleware","edgeApiFunction","matcherSource","isAppDir","normalizeAppPath","catchAll","namedRegex","getNamedMiddlewareRegex","matchers","regexp","originalSource","edgeFunctionDefinition","getFiles","wasm","Array","from","wasmBindings","filePath","assetBindings","regions","getSortedRoutes","Object","keys","MIDDLEWARE_MANIFEST","sources","RawSource","JSON","stringify","buildWebpackError","message","loc","entryModule","parser","error","compiler","webpack","WebpackError","state","current","isInMiddlewareLayer","layer","isNodeJsModule","moduleName","require","builtinModules","includes","isDynamicCodeEvaluationAllowed","fileName","middlewareConfig","rootDir","isMatch","unstable_allowDynamicGlobs","buildUnsupportedApiError","apiName","rest","start","line","registerUnsupportedApiHooks","expression","EDGE_UNSUPPORTED_NODE_APIS","warnForUnsupportedApi","node","warnings","hooks","call","for","tap","callMemberChain","expressionMemberChain","warnForUnsupportedProcessApi","callee","getCodeAnalyzer","dev","handleExpression","optimize","InnerGraph","onUsage","used","buildInfo","getModuleBuildInfo","Set","handleWrapExpression","expr","ConstDependency","dependencies","dep1","range","addPresentationalDependency","dep2","handleWrapWasmCompileExpression","handleWrapWasmInstantiateExpression","handleImport","source","value","importLocByPath","Map","importedModule","toString","set","sourcePosition","identifier","sourceContent","skip","undefined","prefix","new","importCall","import","getExtractMetadata","clear","telemetry","traceGlobals","entryName","entry","entries","route","options","EDGE_RUNTIME_WEBPACK","entryDependency","getResolvedModule","modules","addEntriesFromDependency","dependency","getModule","add","forEach","includeDependencies","entryMetadata","preferredRegion","ogImageGenerationCount","resource","hasOGImageGeneration","test","util","getEntryRuntime","id","record","eventName","payload","absolutePagePath","config","fileWithDynamicCode","userRequest","errors","join","nextEdgeSSR","nextEdgeMiddleware","nextEdgeApiFunction","nextWasmMiddlewareBinding","nextAssetMiddlewareBinding","conn","getOutgoingConnections","EVENT_BUILD_FEATURE_USAGE","featureName","invocationCount","constructor","apply","normalModuleFactory","codeAnalyzer","finishModules","tapPromise","processAssets","stage","Compilation","PROCESS_ASSETS_STAGE_ADDITIONS","supportedEdgePolyfills","records","mod","request","context","contextInfo","getResolve","issuerLayer","has"],"mappings":"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"}