{"version":3,"sources":["../../../../../src/client/components/router-reducer/reducers/navigate-reducer.ts"],"names":["CacheStates","fetchServerResponse","createRecordFromThenable","readRecordValue","createHrefFromUrl","invalidateCacheBelowFlightSegmentPath","fillCacheWithDataProperty","createOptimisticTree","applyRouterStatePatchToTree","shouldHardNavigate","isNavigatingToNewRootLayout","PrefetchKind","handleMutable","applyFlightData","PrefetchCacheEntryStatus","getPrefetchEntryCacheStatus","prunePrefetchCache","handleExternalUrl","state","mutable","url","pendingPush","previousTree","tree","mpaNavigation","canonicalUrl","scrollableSegments","undefined","generateSegmentsFromPatch","flightRouterPatch","segments","segment","parallelRoutes","Object","keys","length","parallelRouteKey","parallelRoute","entries","childSegment","push","addRefetchToLeafSegments","newCache","currentCache","flightSegmentPath","treePatch","data","appliedPatch","status","READY","subTreeData","Map","segmentPathsToFill","map","segmentPaths","res","bailOptimistic","navigateReducer","action","isExternalUrl","navigateType","cache","forceOptimisticNavigation","pathname","hash","href","prefetchCache","isForCurrentTree","JSON","stringify","toString","prefetchValues","get","kind","TEMPORARY","split","optimisticTree","temporaryCacheNode","fetchResponse","nextUrl","buildId","optimisticFlightSegmentPath","slice","flat","patchedTree","hashFragment","set","Promise","resolve","prefetchTime","Date","now","treeAtTimeOfPrefetch","lastUsedTime","newPrefetchValue","prefetchEntryCacheStatus","flightData","canonicalUrlOverride","currentTree","flightDataPath","newTree","applied","reusable","stale","hardNavigate","subSegment","scrollableSegmentPath"],"mappings":"AAAA,SAEEA,WAAW,QACN,4CAA2C;AAKlD,SAASC,mBAAmB,QAAQ,2BAA0B;AAC9D,SAASC,wBAAwB,QAAQ,iCAAgC;AACzE,SAASC,eAAe,QAAQ,uBAAsB;AACtD,SAASC,iBAAiB,QAAQ,0BAAyB;AAC3D,SAASC,qCAAqC,QAAQ,+CAA8C;AACpG,SAASC,yBAAyB,QAAQ,mCAAkC;AAC5E,SAASC,oBAAoB,QAAQ,4BAA2B;AAChE,SAASC,2BAA2B,QAAQ,sCAAqC;AACjF,SAASC,kBAAkB,QAAQ,0BAAyB;AAC5D,SAASC,2BAA2B,QAAQ,sCAAqC;AACjF,SAGEC,YAAY,QAGP,0BAAyB;AAChC,SAASC,aAAa,QAAQ,oBAAmB;AACjD,SAASC,eAAe,QAAQ,uBAAsB;AACtD,SACEC,wBAAwB,EACxBC,2BAA2B,QACtB,qCAAoC;AAC3C,SAASC,kBAAkB,QAAQ,yBAAwB;AAE3D,OAAO,SAASC,kBACdC,KAA2B,EAC3BC,OAAgB,EAChBC,GAAW,EACXC,WAAoB,EACpB;IACAF,QAAQG,YAAY,GAAGJ,MAAMK,IAAI;IACjCJ,QAAQK,aAAa,GAAG,IAAI;IAC5BL,QAAQM,YAAY,GAAGL;IACvBD,QAAQE,WAAW,GAAGA;IACtBF,QAAQO,kBAAkB,GAAGC;IAE7B,OAAOf,cAAcM,OAAOC;AAC9B,CAAC;AAED,SAASS,0BACPC,iBAAoC,EACf;IACrB,MAAMC,WAAgC,EAAE;IACxC,MAAM,CAACC,SAASC,eAAe,GAAGH;IAElC,IAAII,OAAOC,IAAI,CAACF,gBAAgBG,MAAM,KAAK,GAAG;QAC5C,OAAO;YAAC;gBAACJ;aAAQ;SAAC;IACpB,CAAC;IAED,KAAK,MAAM,CAACK,kBAAkBC,cAAc,IAAIJ,OAAOK,OAAO,CAC5DN,gBACC;QACD,KAAK,MAAMO,gBAAgBX,0BAA0BS,eAAgB;YACnE,mEAAmE;YACnE,IAAIN,YAAY,IAAI;gBAClBD,SAASU,IAAI,CAAC;oBAACJ;uBAAqBG;iBAAa;YACnD,OAAO;gBACLT,SAASU,IAAI,CAAC;oBAACT;oBAASK;uBAAqBG;iBAAa;YAC5D,CAAC;QACH;IACF;IAEA,OAAOT;AACT;AAEA,SAASW,yBACPC,QAAmB,EACnBC,YAAuB,EACvBC,iBAAoC,EACpCC,SAA4B,EAC5BC,IAAkD,EAClD;IACA,IAAIC,eAAe,KAAK;IAExBL,SAASM,MAAM,GAAGhD,YAAYiD,KAAK;IACnCP,SAASQ,WAAW,GAAGP,aAAaO,WAAW;IAC/CR,SAASV,cAAc,GAAG,IAAImB,IAAIR,aAAaX,cAAc;IAE7D,MAAMoB,qBAAqBxB,0BAA0BiB,WAAWQ,GAAG,CACjE,CAACtB,UAAY;eAAIa;eAAsBb;SAAQ;IAGjD,KAAK,MAAMuB,gBAAgBF,mBAAoB;QAC7C,MAAMG,MAAMjD,0BACVoC,UACAC,cACAW,cACAR;QAEF,IAAI,CAACS,CAAAA,cAAAA,KAAAA,IAAAA,IAAKC,cAAc,AAAD,GAAG;YACxBT,eAAe,IAAI;QACrB,CAAC;IACH;IAEA,OAAOA;AACT;AACA,OAAO,SAASU,gBACdvC,KAA2B,EAC3BwC,MAAsB,EACR;IACd,MAAM,EACJtC,IAAG,EACHuC,cAAa,EACbC,aAAY,EACZC,MAAK,EACL1C,QAAO,EACP2C,0BAAyB,EAC1B,GAAGJ;IACJ,MAAM,EAAEK,SAAQ,EAAEC,KAAI,EAAE,GAAG5C;IAC3B,MAAM6C,OAAO7D,kBAAkBgB;IAC/B,MAAMC,cAAcuC,iBAAiB;IACrC,wFAAwF;IACxF5C,mBAAmBE,MAAMgD,aAAa;IAEtC,MAAMC,mBACJC,KAAKC,SAAS,CAAClD,QAAQG,YAAY,MAAM8C,KAAKC,SAAS,CAACnD,MAAMK,IAAI;IAEpE,IAAI4C,kBAAkB;QACpB,OAAOvD,cAAcM,OAAOC;IAC9B,CAAC;IAED,IAAIwC,eAAe;QACjB,OAAO1C,kBAAkBC,OAAOC,SAASC,IAAIkD,QAAQ,IAAIjD;IAC3D,CAAC;IAED,IAAIkD,iBAAiBrD,MAAMgD,aAAa,CAACM,GAAG,CAACpE,kBAAkBgB,KAAK,KAAK;IAEzE,IACE0C,6BACAS,CAAAA,yBAAAA,KAAAA,IAAAA,eAAgBE,IAAI,AAAD,MAAM9D,aAAa+D,SAAS,EAC/C;QACA,MAAM5C,WAAWiC,SAASY,KAAK,CAAC;QAChC,wDAAwD;QACxD7C,SAASU,IAAI,CAAC;QAEd,wBAAwB;QACxB,kGAAkG;QAClG,MAAMoC,iBAAiBrE,qBAAqBuB,UAAUZ,MAAMK,IAAI,EAAE,KAAK;QAEvE,8DAA8D;QAC9D,MAAMsD,qBAAgC;YACpC,GAAGhB,KAAK;QACV;QAEA,mDAAmD;QACnD,+DAA+D;QAC/DgB,mBAAmB7B,MAAM,GAAGhD,YAAYiD,KAAK;QAC7C4B,mBAAmB3B,WAAW,GAAGhC,MAAM2C,KAAK,CAACX,WAAW;QACxD2B,mBAAmB7C,cAAc,GAAG,IAAImB,IAAIjC,MAAM2C,KAAK,CAAC7B,cAAc;QAEtE,IAAIc;QAEJ,MAAMgC,gBAAgB,IAAM;YAC1B,IAAI,CAAChC,MAAM;gBACTA,OAAO5C,yBACLD,oBAAoBmB,KAAKwD,gBAAgB1D,MAAM6D,OAAO,EAAE7D,MAAM8D,OAAO;YAEzE,CAAC;YACD,OAAOlC;QACT;QAEA,0EAA0E;QAC1E,6DAA6D;QAC7D,MAAMmC,8BAA8BnD,SACjCoD,KAAK,CAAC,GACN7B,GAAG,CAAC,CAACtB,UAAY;gBAAC;gBAAYA;aAAQ,EACtCoD,IAAI;QAEP,wGAAwG;QACxG,0HAA0H;QAC1H,MAAM5B,MAAMjD,0BACVuE,oBACA3D,MAAM2C,KAAK,EACXoB,6BACAH,eACA,IAAI;QAGN,gFAAgF;QAChF,IAAI,CAACvB,CAAAA,cAAAA,KAAAA,IAAAA,IAAKC,cAAc,AAAD,GAAG;YACxBrC,QAAQG,YAAY,GAAGJ,MAAMK,IAAI;YACjCJ,QAAQiE,WAAW,GAAGR;YACtBzD,QAAQE,WAAW,GAAGA;YACtBF,QAAQkE,YAAY,GAAGrB;YACvB7C,QAAQO,kBAAkB,GAAG,EAAE;YAC/BP,QAAQ0C,KAAK,GAAGgB;YAChB1D,QAAQM,YAAY,GAAGwC;YAEvB/C,MAAMgD,aAAa,CAACoB,GAAG,CAAClF,kBAAkBgB,KAAK,KAAK,GAAG;gBACrD0B,MAAMyC,QAAQC,OAAO,CAAC1C;gBACtB,iEAAiE;gBACjE2B,MAAM9D,aAAa+D,SAAS;gBAC5Be,cAAcC,KAAKC,GAAG;gBACtBC,sBAAsB1E,MAAMK,IAAI;gBAChCsE,cAAcH,KAAKC,GAAG;YACxB;YAEA,OAAO/E,cAAcM,OAAOC;QAC9B,CAAC;IACH,CAAC;IAED,2DAA2D;IAC3D,IAAI,CAACoD,gBAAgB;QACnB,MAAMzB,OAAO5C,yBACXD,oBAAoBmB,KAAKF,MAAMK,IAAI,EAAEL,MAAM6D,OAAO,EAAE7D,MAAM8D,OAAO;QAGnE,MAAMc,mBAAmB;YACvBhD,MAAMyC,QAAQC,OAAO,CAAC1C;YACtB,iEAAiE;YACjE2B,MAAM9D,aAAa+D,SAAS;YAC5Be,cAAcC,KAAKC,GAAG;YACtBC,sBAAsB1E,MAAMK,IAAI;YAChCsE,cAAc,IAAI;QACpB;QAEA3E,MAAMgD,aAAa,CAACoB,GAAG,CAAClF,kBAAkBgB,KAAK,KAAK,GAAG0E;QACvDvB,iBAAiBuB;IACnB,CAAC;IAED,MAAMC,2BAA2BhF,4BAA4BwD;IAE7D,0DAA0D;IAC1D,MAAM,EAAEqB,qBAAoB,EAAE9C,KAAI,EAAE,GAAGyB;IAEvC,0FAA0F;IAC1F,MAAM,CAACyB,YAAYC,qBAAqB,GAAG9F,gBAAgB2C;IAE3D,gGAAgG;IAChGyB,eAAesB,YAAY,GAAGH,KAAKC,GAAG;IAEtC,4DAA4D;IAC5D,IAAI,OAAOK,eAAe,UAAU;QAClC,OAAO/E,kBAAkBC,OAAOC,SAAS6E,YAAY3E;IACvD,CAAC;IAED,IAAI6E,cAAchF,MAAMK,IAAI;IAC5B,IAAIoB,eAAezB,MAAM2C,KAAK;IAC9B,IAAInC,qBAA0C,EAAE;IAChD,KAAK,MAAMyE,kBAAkBH,WAAY;QACvC,MAAMpD,oBAAoBuD,eAAejB,KAAK,CAC5C,GACA,CAAC;QAEH,0DAA0D;QAC1D,MAAM,CAACrC,UAAU,GAAGsD,eAAejB,KAAK,CAAC,CAAC;QAE1C,wEAAwE;QACxE,IAAIkB,UAAU5F,4BACZ,sBAAsB;QACtB;YAAC;eAAOoC;SAAkB,EAC1BsD,aACArD;QAGF,kGAAkG;QAClG,6IAA6I;QAC7I,IAAIuD,YAAY,IAAI,EAAE;YACpBA,UAAU5F,4BACR,sBAAsB;YACtB;gBAAC;mBAAOoC;aAAkB,EAC1BgD,sBACA/C;QAEJ,CAAC;QAED,IAAIuD,YAAY,IAAI,EAAE;YACpB,IAAI1F,4BAA4BwF,aAAaE,UAAU;gBACrD,OAAOnF,kBAAkBC,OAAOC,SAAS8C,MAAM5C;YACjD,CAAC;YAED,IAAIgF,UAAUxF,gBACZ8B,cACAkB,OACAsC,gBACA5B,eAAeE,IAAI,KAAK,UACtBsB,6BAA6BjF,yBAAyBwF,QAAQ;YAGlE,IACE,CAACD,WACDN,6BAA6BjF,yBAAyByF,KAAK,EAC3D;gBACAF,UAAU5D,yBACRoB,OACAlB,cACAC,mBACAC,WACA,wCAAwC;gBACxC,IACE5C,oBAAoBmB,KAAK8E,aAAahF,MAAM6D,OAAO,EAAE7D,MAAM8D,OAAO;YAExE,CAAC;YAED,MAAMwB,eAAe/F,mBACnB,sBAAsB;YACtB;gBAAC;mBAAOmC;aAAkB,EAC1BsD;YAGF,IAAIM,cAAc;gBAChB3C,MAAMb,MAAM,GAAGhD,YAAYiD,KAAK;gBAChC,mDAAmD;gBACnDY,MAAMX,WAAW,GAAGP,aAAaO,WAAW;gBAE5C7C,sCACEwD,OACAlB,cACAC;gBAEF,8EAA8E;gBAC9EzB,QAAQ0C,KAAK,GAAGA;YAClB,OAAO,IAAIwC,SAAS;gBAClBlF,QAAQ0C,KAAK,GAAGA;YAClB,CAAC;YAEDlB,eAAekB;YACfqC,cAAcE;YAEd,KAAK,MAAMK,cAAc7E,0BAA0BiB,WAAY;gBAC7D,MAAM6D,wBAAwB;uBAAI9D;uBAAsB6D;iBAAW;gBACnE,kFAAkF;gBAClF,IACEC,qBAAqB,CAACA,sBAAsBvE,MAAM,GAAG,EAAE,KACvD,eACA;oBACAT,mBAAmBc,IAAI,CAACkE;gBAC1B,CAAC;YACH;QACF,CAAC;IACH;IAEAvF,QAAQG,YAAY,GAAGJ,MAAMK,IAAI;IACjCJ,QAAQiE,WAAW,GAAGc;IACtB/E,QAAQO,kBAAkB,GAAGA;IAC7BP,QAAQM,YAAY,GAAGwE,uBACnB7F,kBAAkB6F,wBAClBhC,IAAI;IACR9C,QAAQE,WAAW,GAAGA;IACtBF,QAAQkE,YAAY,GAAGrB;IAEvB,OAAOpD,cAAcM,OAAOC;AAC9B,CAAC"}